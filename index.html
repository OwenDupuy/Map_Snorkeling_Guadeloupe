<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Snorkeling en Guadeloupe</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map { height: 100vh; width: 100%; }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
  // 1. Création de la carte
  const map = L.map('map').setView([16.265, -61.551], 10);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap'
  }).addTo(map);

  // 2. Liste de spots avec photos + rating 1 à 5
  const spots = [
    {
      name: "Anse Pigeon / Malendure",
      coords: [16.167, -61.789],
      desc: "Tortues, coraux, spot très populaire.",
      rating: 5,
      image: "images/malendure.jpg"
    },
    {
      name: "Réserve Cousteau - Îlets Pigeon",
      coords: [16.1675, -61.794],
      desc: "Poissons tropicaux, coraux en bon état.",
      rating: 4,
      image: "images/ilets_pigeon.jpg"
    },
    {
      name: "Plage de la Caravelle",
      coords: [16.217, -61.387],
      desc: "Lagons calmes, idéal pour débutants.",
      rating: 3,
      image: "images/caravelle.jpg"
    }
  ];

  // 3. Couleurs selon la note
  function getColor(rating) {
    switch (rating) {
      case 5: return "#1a9850"; // vert foncé
      case 4: return "#66bd63"; // vert clair
      case 3: return "#fee08b"; // jaune
      case 2: return "#f46d43"; // orange
      case 1: return "#d73027"; // rouge
      default: return "#888";
    }
  }

  // 4. Affichage des étoiles ★★★★☆
  function getStars(rating) {
    return "★".repeat(rating) + "☆".repeat(5 - rating);
  }

  // 5. Ajout des points (circleMarker) + popup avec photo
  spots.forEach(spot => {
    const color = getColor(spot.rating);

    const popupContent = `
      <b>${spot.name}</b><br>
      ${spot.desc}<br>
      Note : ${getStars(spot.rating)}<br>
      <img src="${spot.image}" alt="${spot.name}"
           style="max-width:200px; margin-top:5px; display:block;">
    `;

    L.circleMarker(spot.coords, {
      radius: 9,
      color: color,
      fillColor: color,
      fillOpacity: 0.9
    })
    .addTo(map)
    .bindPopup(popupContent);
  });

  // 6. Légende étoiles + couleurs
  const legend = L.control({position: 'bottomright'});

  legend.onAdd = function () {
    const div = L.DomUtil.create('div', 'info legend');
    const ratings = [5, 4, 3, 2, 1];

    div.innerHTML += "<b>Qualité du spot</b><br>";

    ratings.forEach(r => {
      div.innerHTML += `
        <i style="
          background:${getColor(r)};
          width:30px; height:30px;
          display:inline-block;
          margin-right:6px;
          border-radius:50%;
        "></i>
        ${getStars(r)}<br>
      `;
    });

    return div;
  };

  legend.addTo(map);
</script>

</body>
</html>

